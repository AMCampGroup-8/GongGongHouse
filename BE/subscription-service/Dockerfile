# 1ë‹¨ê³„: ë¹Œë“œ
FROM gradle:8.7.0-jdk17 AS build
WORKDIR /app
COPY --chown=gradle:gradle . .
RUN gradle build -x test

# 2ë‹¨ê³„: ì‹¤í–‰
FROM openjdk:17-jdk-alpine
WORKDIR /app

# ì„¤ì • íŒŒì¼ ë³µì‚¬
COPY --from=build /app/src/main/resources /app/resources

# JAR ë³µì‚¬
ARG JAR_FILE=build/libs/*.jar
COPY --from=build /app/${JAR_FILE} app.jar

# ğŸ”¥ Springì—ê²Œ ì„¤ì •íŒŒì¼ ê²½ë¡œ ì•Œë ¤ì¤Œ!
ENV SPRING_CONFIG_LOCATION=file:/app/resources/

EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app/app.jar"]

CMD ["java", "-jar", "app.jar", "--spring.profiles.active=dev"]

